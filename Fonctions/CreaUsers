#Creation Utilisateurs
function CreaUsers($User)
{
	$CompteurID = 0
    $User= New-Object psobject -Property @{
            Id = $CompteurID
            Name = "toto-0$CompteurID"
            GivenName = "0"
            Surname = "toto"
            SamAccountName = ""
            UserPrincipalName = ""
            Path = ""
            AccountPassword = ""
            Enabled = $true}

	While ($CompteurID -le 9)
		{
			$CompteurID++
			$CompteurID #Affichage de check
            #Remplissage de l'utilisateur
			$Plettre = $User.Name.subString(0,1) #Recupère la première lettre du Prenom
			$GroupeOU = "Admin-$User.Name" #Groupe incrémenté aussi comme le Name
			$Domain = "maquette.local" 
            $User.SamAccountName = "$Plettre$User.Surname"
            $User.UserPrincipalName = "$User.SamAccountName@$Domain"
            $User.Path = "OU=$GroupeOU,DC=maquette,DC=local"
            $User.AccountPassword = random-password 
            #Check de l'utilisateur et et son groupe (Création/Suppression)
            AddOUforUserX($User)
		}

	$CompteurID = 0
    return $CompteurID
}